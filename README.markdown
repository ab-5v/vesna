При разработке и тестировании почтовых сервисов часто приходится отправлять себе на тестовый ящик разные письма. Чаще всего это письма с темой **test** и с телом **asdf** от самого себя. **Vesna** позволяет слать более полезные письма для тестов.

## Параметры письма
Содержимое письма регулируется следующими параметрами:  

    {
      "body": "1"|"0",          // наличие у письма текстового тела
      "subject": "1"|"0",       // наличие у письма темы
      "thread": "0"|"N"|"N_M",
      "link": "0"|"N"|"N_M",    // количество ссылок в теле письма
      "video": "0"|"N"|"N_M",   // количество ссылок на видео в теле письма
      "attach": "0"|"N"|"N_M"   // количество аттачей в письме
    }
 
Параметры, которым можно задать `N_M` подразумевают рандомное количество айтемов в теле пиьсма, за исключением параметра `thread`:

* если `thread==="0"`, то у всех отправленных писем будут разные темы
* если `thread==="N"`, то у всех отправленных писем будет одна тема (склеятся в тред)
* если `thread==="N_M"`, то у всех отправленных писем будет одна из `M-N` тем (склеятся в `N-M` тредов)

Атачи ищутся в дирректории `/tmp/attach/`


**Vesna** имеет два режима использования:
## HTTP-прокси
В этом режиме создаётся веб-сервер, который ожидает запросов клиента и в зависимости от параметров возвращает json или jsonp c телом и темой письма. Этот режим удобно использовать для букмарклетов.

Запускается как:  
`node app.js`  
Дополнительные параметры:  
`jsonp=some` - возращаемый json будет обёрнут в `some(json)`  
Пример использования:  
`<hostname>/vesna?subject=0&body=0&link=1_2`  
## Mailer
В этом режиме **Vesna** использует утилиту mutt (она должна быть настроена) для отправки писем из командной строки.  
Запускается как:  
`node app.js <config.file> <num>`  
Дополнительные параметры:  
В командной строке:

* `config.file` - конфигурационный файл  
* `num` - количество писем, которые нужно

В конфигурационном файле параметры для содержимого письма находятся в секции `message`, также нужно указать дополнительные паарметы:

* `to` - на какой адрес нужно слать письма  
* `from` - массив из адресов, от имени которых нужно слать письма

Пример конфигурационного файла есть в репозитории.
